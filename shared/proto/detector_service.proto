syntax = "proto3";

package aa.shared;

option cc_enable_arenas = true;

// Video frame data representing OpenCV cv::Mat
message Frame {
  int32 rows = 1;      // Number of rows (height)
  int32 cols = 2;      // Number of columns (width)
  int32 elm_type = 3;  // Element type (CV_8UC3, CV_32FC1, etc.)
  int32 elm_size = 4;  // Size of each element in bytes
  bytes data = 5;      // Raw pixel data
}

// Processing request
message ProcessRequest {
  Frame frame = 1;
  string operation = 2;  // e.g., "blur", "edge_detect", "resize"
  map<string, string> parameters = 3;
}

// Processing response
message ProcessResponse {
  Frame result = 1;
  bool success = 2;
  string error_message = 3;
  double processing_time_ms = 4;
}

// Health check
message CheckHealthRequest {}

message CheckHealthResponse {
  bool healthy = 1;
  string status = 2;
}

// Detection service
service DetectorService {
  rpc ProcessFrame(ProcessRequest) returns (ProcessResponse);
  rpc CheckHealth(CheckHealthRequest) returns (CheckHealthResponse);
}
